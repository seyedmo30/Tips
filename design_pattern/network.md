
# NETWORK

## nat


لپ تاپ ما یه آی پی داره که توی روتر فقط معنی داره مثل 192.168.1.100 ولی وقتی درخواست می خواد به به اینترنت وصل شه باید Network address translation اتفاق بیفته یعنی پابلیک آی پی که  - isp - مخابرات به ما داده درخواست بکنه ، پاسخ که اومد با nat  دوباره به کامپیوتر داده بشه ، در حقیقت با nat میشه درخواست به بیرون داده یا پاسخ رو گرفت


اگر یک شبکه ی پرایویت داشته باشیم و همه ی آن ها از طریق یک IP static به اینترنت وصل شوند ، در این صورت از نت استفاده کردیم .


به منظور ایجاد یک NAT (Network Address Translation) برای ترافیک شبکه، می‌توان از دستور `iptables` در لینوکس استفاده کرد. این دستور به شما امکان می‌دهد تا
 قوانین ترافیک شبکه را تعریف و مدیریت کنید.
 برای پیکربندی NAT، می‌توان از دستورات زیر استفاده کرد:
 + فعال کردن NAT
 iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
 + ترافیک ورودی به پورت 80 را به پورت 8000 هدایت کن
 iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-ports 8000

### dns over https (doh)

چون udp  دیکیریپت و انکریپت نمیشه ، می تونیم بعضی از درخواست ها رو با یه dns  خاص بندازیم تا رمزنگاری بکنه

+ dmz

توی روتر ها می تونیم آدرسی ست کنیم که از بیرون ًابل مشاهده باشه

با این که isp  یا مخابرات آدرس ثابت نمی ده ولی همون آیپی شاید ۲ روز ثابت باشه ، اگر این آی پی رو کال کنیم ، تا روتر میاد و اگر این قابلیت رو کانفیگ کنیم ، می تونیم از بیرون کامپیوتر خودمون رو ببنیم

### tips

+ **URI (Uniform Resource Identifier)**

یه استرینگ برای شناسایی یه منبعه می تونه یا آدرسش باشه ، یا نامش باشه ولی شناسه و یونیکه

+ **URL (Uniform Resource Locator)**

یکی از زیر مجموعه های URI هست و برای مکان یا ادرس در شبکه یا وب استفاده می شود و محدود به http , ftp  نیست

مولفه های زیر رو داراست :

پروتوکول ، هاست ، مسیر ، کوییری پارام

### proxy

+ **forward proxy**
توی این روشمی تونیم امنیت و سکیوریتی کاربر رو بالا ببریم

مانند استفاده از شکن 

در این حالت اینترنت با آی پی واقعی کاربر روبرو نیست

```
user --------> proxy ------> internet -------> server

```

+ **reverse proxy**

در این حالت ما درخواست به سرور می زنیم و در پیش سرور در خواست ها به چندین سرور داخلی می رسه که ما نمی بینیم مانند load balancer

مثل nginx , load balancer

```
user  ------> internet --------> proxy -------> server

```


### لایه های شبکه

+ **application layer**

+ **Session Layer** 

توجه شود IP استیت لس هست و به صورت فیزیکال کانکشنی وجود ندارد ، تنها داده ارسال میشود

با این لایه می توان به صورت logical  کانکشن رو برقرار کنیم راه هایی مانند باز کردن پورت 


+ **transport layer**

در این لایه مسعولیت تیکه تیکه کردن داده و ارور هندل و کنترل ترتیب و صحت دریافت هندل میشه

دو پروتوکول اصلی TCP (Transmission Control Protocol) and UDP (User Datagram Protocol) میشه مدیریت کرد سگمنت ها و پکت ها رو
+ **network layer**

در اینجا ارتباط بین نتوروک ها مطرح است و به صورت logical  و نه فیزیکال مسيله حل می شود . 

با استفاده از  IP (Internet Protocol) پکت ها رو به بیرون شبکه روتینگ کرد

+ **Data Link Layer**

در این لایه هنوز IP تعریفی ندارد و ارتباط بین ماشین در شبکه محلی LAN مطرح است

اینجا از MAC addresses استفاده میشه و نود های درون یک شبکه محلی هنوز از شبکه های محلی بیرونی خبری ندارد ، تنها MAC addresses های درونی رو میشناسن

+ **physical layer**

توی این لایه تنها بحث تبدیل ولتاژ منفی و مثبت به 0 و 1 هست